# **TrussC vs openFrameworks: Evolution & Philosophy**

TrussC deeply respects and inherits the "joy of creative coding" and "intuitive programming experience" that openFrameworks (oF) has built.

However, the hardware performance, C++ language specifications, and application complexity requirements differ significantly between the early 2000s when oF was designed and today.

This document explains **what TrussC inherited** from oF, **what it changed**, and **what benefits those changes bring**.

## **1. Shared DNA: The Unchanged "Joy"**

To let oF users start writing with TrussC without feeling out of place, the following core concepts are intentionally maintained.

| Item | openFrameworks | TrussC | Notes |
|:-----|:---------------|:-------|:------|
| **Lifecycle** | setup, update, draw | setup, update, draw | The basic rhythm of creative coding. This structure is unchanged. |
| **Immediate Drawing** | ofDrawCircle(x, y, r) | tc::drawCircle(Vec3 pos, r) | The magical simplicity of "write one line, get a picture" must never be lost. |
| **State Machine** | ofSetColor, ofPushMatrix | tc::setColor, tc::pushMatrix | Following the style of modifying state and drawing. |
| **Learning Curve** | Beginner-friendly | Beginner-friendly | Complex GPU concepts (command buffers, descriptor heaps, etc.) are hidden, letting anyone express through code. |

## **2. Differences: Adaptation to Modern Era (Evolution & Merits)**

TrussC has undergone bold structural reforms to solve "complexity" and "performance" challenges in modern application development.

### **A. Structure and Coordinates: Scene Graph Introduction**

* **openFrameworks:**
  * **Structure:** Basically flat. Creating parent-child relationships required manually managing ofNode or calculating transforms yourself.
  * **Coordinates:** Mouse events always arrive as "absolute coordinates from screen top-left". Click detection on rotated objects required difficult calculations.
  * **Issue:** UI or works with complex hierarchies overflow with coordinate transformation code.
* **TrussC:**
  * **Structure:** **Scene graph (tc::Node)** as standard. Like Unity's GameObject, parent-child relationships are assumed.
  * **Coordinates:** Mouse events are automatically transformed, arriving as **"local coordinates for that object"**.
  * **Benefits:**
    * Even "a button inside a rotating parent" can be detected with just rect.contains(pos).
    * Per-group movement, rotation, and visibility toggling becomes extremely easy.

### **B. Rendering Backend: Breaking Away from OpenGL**

* **openFrameworks:**
  * **Technology:** OpenGL (Legacy & Modern).
  * **Issue:** Apple (macOS/iOS) deprecated OpenGL and migrated to Metal, making future operation guarantees and performance optimization difficult.
* **TrussC:**
  * **Technology:** **Sokol (Metal / DirectX 11/12 / Vulkan / WebGPU)**.
  * **Benefits:**
    * Runs on the latest native APIs recommended by the OS, meaning **fast and power-efficient**.
    * Binary size becomes overwhelmingly smaller.
    * Portability to web browsers (WebAssembly + WebGPU) also improves.

### **C. Memory Management: Modern C++ Safety**

* **openFrameworks:**
  * **Policy:** Mix of raw pointers (*) and custom smart pointers (ofPtr).
  * **Issue:** Frequent accidents where beginners forget delete causing memory leaks, or access invalid pointers causing crashes.
* **TrussC:**
  * **Policy:** Full adoption of **std::shared_ptr / std::weak_ptr (C++11+)**.
  * **Benefits:**
    * When parent node disappears, child nodes automatically disappear too.
    * Users almost never need to think about memory deallocation.
    * Excellent compatibility with modern C++ code generated by AI (LLMs).

### **D. Time and Async: Safe Timers**

* **openFrameworks:**
  * **Method:** Use ofThread or manually measure time in update with if statements.
  * **Issue:** Multi-threading easily causes data races, debugging is hell. Branches in update make code messy.
* **TrussC:**
  * **Method:** **Synchronous timers (callAfter, callEvery)**.
  * **Benefits:**
    * Processing like "execute this function after 3 seconds" can be written **safely on the main thread**.
    * No mutex needed, no worry about variable races.

### **E. Dependencies and Build: Minimalism & CMake**

* **openFrameworks:**
  * **Configuration:** "Battery Included" (everything included).
  * **Issues:**
    * Even apps that "just draw one rectangle" become hundreds of MB in size with long build times.
    * Adding addons requires manually managing header paths and link settings, prone to **"library exists but link error"** issues.
* **TrussC:**
  * **Configuration:** **"Thin Wrapper" + CMake**.
  * **Benefits:**
    * **Automatic dependency resolution:** Just specify addon in one line with target_link_libraries, and all needed header paths and link settings propagate automatically.
    * **Lightweight:** Blazing fast compilation, lightweight executables.
    * **Addon naming:** Unified with tc (TrussC) prefix, extensions treated as "standard parts".

### **F. Addon System**

* **openFrameworks:**
  * **Naming:** `ofx` prefix (e.g.: `ofxGui`, `ofxOsc`)
  * **Installation:** Select checkboxes in projectGenerator, or write in `addons.make` file.
  * **Build:** Often requires manually adding paths to IDE project settings.
  * **Namespace:** No standard convention, often defined directly in global namespace.
  * **Issue:** Manual dependency resolution between addons. If "ofxA depends on ofxB", both must be written in addons.make.

* **TrussC:**
  * **Naming:** `tcx` prefix (e.g.: `tcxBox2d`, `tcxOsc`)
  * **Installation:** Just add one line to CMakeLists.txt.
    ```cmake
    use_addon(${PROJECT_NAME} tcxBox2d)
    ```
  * **Build:** CMake automatically sets include paths and library links.
  * **Namespace:** Unified as `tcx::addonname` (e.g.: `tcx::box2d::World`).
  * **Benefits:**
    * **Automatic dependency resolution:** If tcxA depends on tcxB, just `use_addon(app tcxA)` automatically links tcxB too.
    * **FetchContent compatible:** External libraries can be auto-downloaded via CMake's FetchContent.
    * **Name collision avoidance:** Organized namespaces make it safe even when multiple addons have same-named classes.

**Folder Structure Comparison:**

| Item | openFrameworks | TrussC |
|:-----|:---------------|:-------|
| Location | `of/addons/ofxName/` | `trussc/addons/tcxName/` |
| Source code | `src/` | `src/` |
| Headers | `src/` (mixed) | `include/tcxName/` (separate) |
| Examples | `example/` | `examples/` |
| Build config | `addon_config.mk` | `CMakeLists.txt` |

See [ADDONS.md](ADDONS.md) for details.

## **3. Which Should You Choose?**

### **Choose openFrameworks if:**

* You want to use the massive addon assets (ofxAddon) from the past as-is.
* You want to reference 10 years' worth of tutorials and sample code on the internet.
* You need stable connections with Kinect v1/v2 or old peripherals.

### **Choose TrussC if:**

* You want to minimize license issues and crash risks for **"commercial projects"**.
* You want to create complex applications with **"modern UI"** and interactions.
* You want to pair program with **"AI (ChatGPT/Claude)"** and write code in modern C++.
* You want fast builds and quick experimentation.

TrussC is built with respect for oF, as **"a new foundation (Truss) for fighting the next 10 years"**.

---

## **4. Solutions to oF Pain Points**

Solutions in TrussC for problems that have plagued oF users for years.

### **Thick Line Drawing**

**oF Problem:**
- `ofSetLineWidth()` can't guarantee thickness beyond 1px due to OpenGL limitations
- Completely ignored on macOS / Metal environments
- Drawing thick lines required generating meshes yourself

**TrussC Solution:**
```cpp
// Beautiful thick lines with beginStroke/endStroke
setStrokeWeight(5.0f);  // 5px thick line
beginStroke();
vertex(0, 0);
vertex(100, 50);
vertex(200, 0);
endStroke();  // Automatic line caps and joins
```

### **Update and Draw Cycle Control**

**oF Problem:**
- `ofSetFrameRate()` always couples Draw and Update
- Difficult when wanting to run physics simulation at fixed timestep
- Hard to make event-driven apps (redraw only on button press)

**TrussC Solution:**
```cpp
// Default: VSync mode (update and draw synced to monitor)
tc::setFps(VSYNC);

// Fixed FPS (update and draw synced)
tc::setFps(60);

// Independent rates (e.g., physics at 120Hz, draw at VSync)
tc::setIndependentFps(120, VSYNC);

// Event-driven (power-saving mode)
tc::setFps(EVENT_DRIVEN);
// Call tc::redraw() on mousePressed etc. to trigger draw
```

### **Scene Graph and Parent-Child Relationships (Node)**

**oF Problem:**
- `ofNode` exists but parent-child management is manual
- Adding/removing child nodes makes memory management complex
- Children remain when parent disappears

**TrussC Solution:**
```cpp
// shared_ptr based automatic management
auto parent = tc::Node::create();
auto child = tc::Node::create();
parent->addChild(child);

// Destroying parent automatically releases children
// Circular references safely avoided with weak_ptr
```

### **Mouse Events in Local Coordinates**

**oF Problem:**
- Mouse coordinates are always screen coordinates (top-left origin)
- Click detection on rotated/scaled objects is hell
- Even using `ofNode`, coordinate transformation is self-calculated

**TrussC Solution:**
```cpp
// RectNode automatically converts to local coordinates
class MyButton : public tc::RectNode {
    bool onMousePress(tc::Vec2 local, int button) override {
        // local is coordinates "for this node"
        // Even if parent is rotated, arrives in own local coordinates
        if (local.x < width/2) {
            // Left half clicked
        }
        return true;  // Consume event
    }
};
```

### **Hit Testing (Collision Detection)**

**oF Problem:**
- Detection when multiple objects overlap is tedious
- Z-order (draw order) aware detection requires custom implementation

**TrussC Solution:**
```cpp
// RectNode automatically considers Z-order
// Front nodes receive events preferentially
// If event is "consumed", it doesn't propagate behind

bool onMousePress(tc::Vec2 local, int button) override {
    // Return true to consume event, nodes behind don't receive it
    return true;
}
```

### **Thread-Safe Timers**

**oF Problem:**
- `ofThread` easily causes data races
- No standard safe way to "execute after 3 seconds"

**TrussC Solution:**
```cpp
// Safe delayed execution on main thread
node->addTimerFunction(3.0f, []() {
    // Executed on main thread after 3 seconds
    // No Mutex needed, no data race worries
});
```

---

## **5. API Mapping (oF â†’ TrussC)**

Reference for oF users finding equivalent features in TrussC.

<!-- AUTO-GENERATED-START -->

### **App Structure**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofGetWidth` | `getWindowWidth()` |  |
| `ofGetHeight` | `getWindowHeight()` |  |
| `ofGetWindowSize` | `getWindowSize()` |  |
| `ofGetMouseX` | `getMouseX()` |  |
| `ofGetMouseY` | `getMouseY()` |  |
| `ofGetMousePressed` | `isMousePressed()` |  |

### **Graphics**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofClear / ofBackground` | `clear(gray)` |  |
| `ofSetColor` | `setColor(gray)` | Range 0-1 instead of 0-255 |
| `ofDrawRectangle` | `drawRect(x, y, w, h)` |  |
| `ofDrawRectRounded` | `drawRectRounded(x, y, w, h, radius)` |  |
| `ofDrawCircle` | `drawCircle(x, y, radius)` |  |
| `ofDrawEllipse` | `drawEllipse(x, y, w, h)` |  |
| `ofDrawLine` | `drawLine(x1, y1, x2, y2)` |  |
| `ofDrawTriangle` | `drawTriangle(x1, y1, x2, y2, x3, y3)` |  |
| `ofDrawBox` | `drawBox(size)` |  |
| `ofDrawSphere` | `drawSphere(radius)` |  |
| `ofDrawCone` | `drawCone(radius, height)` |  |
| `ofBeginShape` | `beginShape()` |  |
| `ofVertex` | `vertex(x, y)` |  |
| `ofEndShape` | `endShape(close)` |  |
| `ofDrawBitmapString` | `drawBitmapString(text, x, y)` |  |
| `ofSetFrameRate` | `setFps(fps)` |  |
| `ofFill` | `fill()` |  |
| `ofNoFill` | `noFill()` |  |
| `ofSetLineWidth` | `setStrokeWeight(weight)` |  |
| `ofSetCircleResolution` | `setCircleResolution(resolution)` |  |
| `ofPushStyle` | `pushStyle()` |  |
| `ofPopStyle` | `popStyle()` |  |

### **Transform**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofTranslate` | `translate(x, y)` |  |
| `ofRotateRad` | `rotate(radians)` | Always radians (not degrees like oF default) |
| `ofRotateDeg` | `rotateDeg(degrees)` |  |
| `ofScale` | `scale(s)` |  |
| `ofPushMatrix` | `pushMatrix()` |  |
| `ofPopMatrix` | `popMatrix()` |  |

### **Math**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofRandom` | `random()` |  |
| `ofSeedRandom` | `randomSeed(seed)` |  |
| `ofNoise` | `noise(x)` |  |
| `ofSignedNoise` | `signedNoise(x)` |  |
| `ofLerp` | `lerp(a, b, t)` |  |
| `ofClamp` | `clamp(v, min, max)` |  |
| `ofMap` | `map(v, inMin, inMax, outMin, outMax)` |  |
| `ofDegToRad` | `deg2rad(degrees)` |  |
| `ofRadToDeg` | `rad2deg(radians)` |  |
| `ofSign` | `sign(x)` |  |
| `ofWrap` | `wrap(value, min, max)` |  |
| `ofAngleDifferenceRadians` | `angleDifference(angle1, angle2)` |  |
| `ofAngleDifferenceDegrees` | `angleDifferenceDeg(deg1, deg2)` |  |
| `ofDist` | `dist(x1, y1, x2, y2)` |  |
| `ofDistSquared` | `distSquared(x1, y1, x2, y2)` |  |

### **Font**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofTrueTypeFont` | `Font` |  |
| `font.load("font.ttf", size)` | `font.load("font.ttf", size)` | Same |
| `font.drawString(text, x, y)` | `font.drawString(text, x, y)` | Same |

### **3D Primitives**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofSetupScreenPerspective` | `setupScreenPerspective()` |  |
| `ofSetupScreenOrtho` | `setupScreenOrtho()` |  |

### **Video**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofVideoGrabber` | `VideoGrabber` |  |
| `grabber.setup(w, h)` | `grabber.setup(w, h)` |  |
| `grabber.update()` | `grabber.update()` |  |
| `grabber.draw(x, y)` | `grabber.draw(x, y)` |  |
| `grabber.isFrameNew()` | `grabber.isFrameNew()` |  |

### **Time**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofGetLastFrameTime` | `getDeltaTime()` |  |
| `ofGetFrameRate` | `getFrameRate()` |  |
| `ofGetFrameNum` | `getFrameCount()` |  |
| `ofGetElapsedTimef` | `getElapsedTimef()` |  |
| `ofGetElapsedTimeMillis` | `getElapsedTimeMillis()` |  |
| `ofGetElapsedTimeMicros` | `getElapsedTimeMicros()` |  |
| `ofResetElapsedTimeCounter` | `resetElapsedTimeCounter()` |  |
| `ofGetSystemTimeMillis` | `getSystemTimeMillis()` |  |
| `ofGetTimestampString` | `getTimestampString()` |  |
| `ofGetSeconds` | `getSeconds()` |  |
| `ofGetMinutes` | `getMinutes()` |  |
| `ofGetHours` | `getHours()` |  |
| `ofGetYear` | `getYear()` |  |
| `ofGetMonth` | `getMonth()` |  |
| `ofGetDay` | `getDay()` |  |
| `ofGetWeekday` | `getWeekday()` |  |

### **Utility**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofLog` | `logNotice(message)` |  |
| `ofToString` | `toString(value)` |  |
| `ofToInt` | `toInt(str)` |  |
| `ofToFloat` | `toFloat(str)` |  |
| `ofSplitString` | `splitString(source, delimiter)` |  |
| `ofJoinString` | `joinString(elements, delimiter)` |  |
| `ofStringReplace` | `stringReplace(input, search, replace)` |  |
| `ofToLower` | `toLower(src)` |  |
| `ofToUpper` | `toUpper(src)` |  |

### **GUI**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofxGui / ofxImGui` | `ImGui (built-in)` | Included by default |

### **I/O**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofSystemLoadDialog()` | `systemLoadDialog()` |  |
| `ofSystemSaveDialog()` | `systemSaveDialog()` |  |
| `ofLoadJson(path)` | `loadJson(path)` | nlohmann/json |
| `-` | `loadXml(path)` | pugixml |

### **Network**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofxTCPClient` | `TcpClient` |  |
| `ofxTCPServer` | `TcpServer` |  |
| `ofxUDPManager` | `UdpSocket` |  |
| `ofxOsc` | `OscReceiver / OscSender` |  |

### **Log**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofLog()` | `logNotice()` |  |
| `ofLogWarning()` | `logWarning()` |  |
| `ofLogError()` | `logError()` |  |

### **Thread**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofThread` | `std::thread + MainThreadRunner` | Safe sync |
| `-` | `MainThreadRunner::run(func)` | Execute on main thread |

### **Serial**

| openFrameworks | TrussC | Notes |
|:---|:---|:---|
| `ofSerial` | `Serial` |  |
| `serial.setup(port, baud)` | `serial.setup(port, baud)` | Same |
| `serial.readBytes(...)` | `serial.readBytes(...)` | Same |
| `serial.writeBytes(...)` | `serial.writeBytes(...)` | Same |

<!-- AUTO-GENERATED-END -->
